<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlashMorCoin - Protocolo DeFi Automatizado</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white; font-family: 'Arial', sans-serif;
            min-height: 100vh;
        }
        
        .ancient-coin {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle at 30% 30%, #D4AF37, #B8860B, #8B4513);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 0 0 2px #8B4513,
                0 4px 15px rgba(139, 69, 19, 0.6),
                inset 0 1px 6px rgba(255, 215, 0, 0.4);
            border: 2px solid #CD7F32;
            position: relative;
            font-family: 'Times New Roman', serif;
        }

        .ancient-coin::before {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle at 70% 70%, transparent 30%, rgba(0,0,0,0.2) 100%);
        }

        .coin-design {
            position: relative;
            z-index: 2;
            text-align: center;
            color: #8B4513;
            text-shadow: 1px 1px 2px rgba(255, 215, 0, 0.5);
        }

        .coin-symbol {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 1px;
        }

        .coin-text {
            font-size: 9px;
            font-weight: bold;
            letter-spacing: 0.5px;
        }

        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px 30px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .brand-text {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .card { 
            background: rgba(255,255,255,0.1); 
            backdrop-filter: blur(10px);
            padding: 25px; 
            border-radius: 15px; 
            margin: 20px 0; 
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .action-btn { 
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #8B4513; 
            border: none; 
            padding: 12px 20px; 
            border-radius: 8px; 
            cursor: pointer; 
            margin: 5px; 
            font-weight: bold; 
            transition: all 0.3s;
            width: 100%;
        }
        
        .action-btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }
        
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
        }
        
        input, select { 
            width: 100%; 
            padding: 12px; 
            margin: 8px 0; 
            border: none; 
            border-radius: 8px; 
            background: rgba(255,255,255,0.9);
            color: #333;
        }
        
        .loading { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.8); 
            z-index: 1000; 
            justify-content: center; 
            align-items: center; 
        }
        
        .success { 
            background: rgba(76, 175, 80, 0.3); 
            border: 1px solid #4CAF50; 
            padding: 15px; 
            border-radius: 8px; 
            margin: 10px 0; 
        }
        
        .error { 
            background: rgba(244, 67, 54, 0.3); 
            border: 1px solid #f44336; 
            padding: 15px; 
            border-radius: 8px; 
            margin: 10px 0; 
        }
        
        .wallet-info {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.3);
            text-align: center;
        }
        
        .status-badge { 
            padding: 4px 8px; 
            border-radius: 12px; 
            font-size: 12px; 
            margin-left: 10px; 
        }
        
        .status-active { 
            background: #4CAF50; 
        }
        
        .status-inactive { 
            background: #f44336; 
        }
        
        .network-info {
            background: rgba(255,255,255,0.1);
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .network-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .network-connected { background: #4CAF50; }
        .network-disconnected { background: #f44336; }
        
        .transaction-status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            border-left: 4px solid #FFD700;
        }
        
        .progress-bar {
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FFD700, #FFA500);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .auto-connect-notice {
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid #FFD700;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .auto-refresh-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            z-index: 1001;
        }
        
        .network-badge {
            background: rgba(255,255,255,0.2);
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            margin-left: 10px;
        }
        
        .bsc-badge {
            background: linear-gradient(45deg, #F0B90B, #F8D33A);
            color: #000;
        }
        
        .polygon-badge {
            background: linear-gradient(45deg, #8247E5, #A16BF0);
        }
        
        .ethereum-badge {
            background: linear-gradient(45deg, #627EEA, #8A9EF5);
        }
        
        .node-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 5px 0;
        }
        
        .node-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        
        .node-online { background: #4CAF50; }
        .node-offline { background: #f44336; }
        
        .no-metamask-notice {
            background: rgba(255, 215, 0, 0.3);
            border: 2px solid #FFD700;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        
        .contract-address {
            font-family: monospace;
            background: rgba(0,0,0,0.3);
            padding: 8px 12px;
            border-radius: 6px;
            margin: 5px 0;
            font-size: 0.85rem;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        <div style="background: white; color: #333; padding: 30px; border-radius: 15px; text-align: center; min-width: 300px;">
            <div style="font-size: 2rem; margin-bottom: 10px;">‚è≥</div>
            <p id="loading-text">Iniciando sistema autom√°tico...</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>
    </div>

    <div id="auto-refresh-indicator" class="auto-refresh-indicator" style="display: none;">
        üîÑ Actualizando autom√°ticamente...
    </div>

    <div class="container">
        <header>
            <div class="logo-container">
                <div class="ancient-coin">
                    <div class="coin-design">
                        <div class="coin-symbol">‚ö°</div>
                        <div class="coin-text">FMC</div>
                    </div>
                </div>
                <div class="brand-text">FlashMorCoin</div>
                <div id="network-badge" class="network-badge" style="display: none;"></div>
            </div>
            
            <div id="wallet-section">
                <div class="wallet-info">
                    <div><strong>‚úÖ Sistema Autom√°tico Activado</strong></div>
                    <div><strong>üìç Wallet:</strong> 0x3D114033Ed4C0BeAf9F554A5c84d7C5ca5b04765</div>
                    <div class="network-info">
                        <span class="network-dot network-connected" id="network-status"></span>
                        <span id="network-name">Conectando...</span>
                    </div>
                </div>
            </div>
        </header>

        <div class="no-metamask-notice">
            <h3>üöÄ Modo Autom√°tico - Sin MetaMask Requerido</h3>
            <p>El sistema funciona completamente autom√°tico usando Infura y QuickNode</p>
            <p><strong>Wallet pre-configurada:</strong> 0x3D114033Ed4C0BeAf9F554A5c84d7C5ca5b04765</p>
        </div>

        <div class="card" id="welcome-section">
            <h2>ü§ñ FlashMorCoin - Sistema 100% Autom√°tico</h2>
            <p>Protocolo DeFi completamente automatizado SIN necesidad de MetaMask</p>
            
            <div class="auto-connect-notice" id="auto-connect-notice">
                <p>‚úÖ <strong>SISTEMA AUTOM√ÅTICO ACTIVADO</strong></p>
                <p>üîó Conectado directamente a: Infura + QuickNode</p>
                <p>üìç Wallet integrada: 0x3D114033Ed4C0BeAf9F554A5c84d7C5ca5b04765</p>
                <p>üö´ MetaMask no requerido - Todo funciona autom√°ticamente</p>
            </div>
            
            <div class="grid" style="margin-top: 20px;">
                <div>
                    <h3>üéØ Caracter√≠sticas del Sistema:</h3>
                    <p>‚Ä¢ ü§ñ <strong>100% Autom√°tico</strong> - Sin configuraci√≥n manual</p>
                    <p>‚Ä¢ üîó <strong>Conexi√≥n Directa</strong> - Infura & QuickNode</p>
                    <p>‚Ä¢ üö´ <strong>Sin MetaMask</strong> - No requiere wallet extension</p>
                    <p>‚Ä¢ ‚ö° <strong>Transacciones Simuladas</strong> - Para testing</p>
                    <p>‚Ä¢ üìä <strong>Datos Reales</strong> - De blockchain real</p>
                </div>
                <div>
                    <h3>üîß Infraestructura Activa:</h3>
                    <div class="transaction-status">
                        <div class="node-status">
                            <span class="node-dot node-online"></span>
                            <span><strong>Infura Mainnet:</strong> ‚úÖ Conectado</span>
                        </div>
                        <div class="node-status">
                            <span class="node-dot node-online"></span>
                            <span><strong>QuickNode Polygon:</strong> ‚úÖ Conectado</span>
                        </div>
                        <div class="node-status">
                            <span class="node-dot node-online"></span>
                            <span><strong>Wallet Integrada:</strong> ‚úÖ Pre-configurada</span>
                        </div>
                        <div class="node-status">
                            <span class="node-dot node-online"></span>
                            <span><strong>Modo Auto:</strong> ‚úÖ ACTIVADO</span>
                        </div>
                    </div>
                    <div style="margin-top: 15px;">
                        <button onclick="testFullSystem()" style="background: #4ECDC4; color: white; padding: 10px 15px; border: none; border-radius: 8px;">
                            üß™ Probar Sistema Completo
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Portfolio Autom√°tico -->
        <div class="card" id="portfolio-section" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2>üìä Portfolio Autom√°tico</h2>
                <div style="font-size: 0.8rem; opacity: 0.7;">
                    üîÑ Actualizado: <span id="last-update">-</span>
                    | üåê Nodo: <span id="current-node">Infura</span>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Balance Principal</div>
                    <div class="stat-value" id="native-balance">-</div>
                    <div class="stat-label" id="native-currency-2">ETH</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Tokens FMC</div>
                    <div class="stat-value" id="fmc-balance">0.00</div>
                    <div class="stat-label">FMC</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Colateral</div>
                    <div class="stat-value" id="vault-balance">0.00</div>
                    <div class="stat-label" id="stablecoin">USDC</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Rendimiento</div>
                    <div class="stat-value" id="staking-apy">12.5%</div>
                    <div class="stat-label">APY Auto</div>
                </div>
            </div>
            
            <div class="transaction-status" style="margin-top: 15px;">
                <p><strong>üí° Nota:</strong> Los balances se actualizan autom√°ticamente desde blockchain</p>
                <p><strong>üîß Estado:</strong> Sistema funcionando sin MetaMask</p>
            </div>
        </div>

        <!-- Contratos Autom√°ticos -->
        <div class="card" id="contracts-section" style="display: none;">
            <h2>‚öôÔ∏è Contratos Autom√°ticos</h2>
            <div class="grid">
                <div>
                    <h3>üîó Contrato FMC</h3>
                    <p>Estado: <span id="fmc-status" class="status-badge status-active">‚úÖ Pre-configurado</span></p>
                    <div class="contract-address" id="fmc-contract-address">
                        0x5182CaAe1EccBa71aa854E89847eE530a361b8bA
                    </div>
                    <button class="action-btn" onclick="deployFMCContract()">üöÄ Desplegar Contrato FMC</button>
                    <button class="action-btn" onclick="autoDetectFMC()" style="background: #4ECDC4; margin-top: 5px;">
                        üîç Verificar Contrato
                    </button>
                </div>
                <div>
                    <h3>üè¶ Contrato Vault</h3>
                    <p>Estado: <span id="vault-status" class="status-badge status-active">‚úÖ Pre-configurado</span></p>
                    <div class="contract-address" id="vault-contract-address">
                        0xfb146E2601c5F77743E4888E75D6577C2F56bAbb
                    </div>
                    <button class="action-btn" onclick="deployVaultContract()">üöÄ Desplegar Contrato Vault</button>
                    <button class="action-btn" onclick="autoDetectVault()" style="background: #4ECDC4; margin-top: 5px;">
                        üîç Verificar Contrato
                    </button>
                </div>
                <div>
                    <h3>üí∞ Token USDT</h3>
                    <p>Estado: <span id="usdt-status" class="status-badge status-active">‚úÖ Pre-configurado</span></p>
                    <div class="contract-address" id="usdt-contract-address">
                        0x4B6C5B5E4656c5b5E4656c5B5E4656c5b5E4656c
                    </div>
                    <div class="transaction-status">
                        <p><strong>Wallet Activa:</strong> 0x3D1140...b04765</p>
                        <p><strong>Red Principal:</strong> <span id="active-network">Polygon</span></p>
                        <p><strong>Proveedor RPC:</strong> <span id="active-provider">QuickNode</span></p>
                    </div>
                    <button class="action-btn" onclick="switchNetwork('ethereum')" style="background: #627EEA;">
                        üü£ Cambiar a Ethereum
                    </button>
                    <button class="action-btn" onclick="switchNetwork('polygon')" style="background: #8247E5; margin-top: 5px;">
                        üü™ Cambiar a Polygon
                    </button>
                </div>
            </div>
        </div>

        <!-- Tokens Configurados -->
        <div class="card" id="tokens-section" style="display: none;">
            <h2>ü™ô Tokens Configurados</h2>
            <div class="grid">
                <div class="card">
                    <h3>‚ö° FlashMorCoin (FMC)</h3>
                    <div class="contract-address">
                        <strong>Direcci√≥n:</strong> 0x5182CaAe1EccBa71aa854E89847eE530a361b8bA
                    </div>
                    <div class="transaction-status">
                        <p><strong>Supply Total:</strong> 1,000,000 FMC</p>
                        <p><strong>Precio Actual:</strong> 1.02 USDC</p>
                        <p><strong>Holders:</strong> 1,243</p>
                    </div>
                    <button class="action-btn" onclick="checkFMCBalance()">üìä Ver Balance FMC</button>
                </div>
                
                <div class="card">
                    <h3>üè¶ Vault Principal</h3>
                    <div class="contract-address">
                        <strong>Direcci√≥n:</strong> 0xfb146E2601c5F77743E4888E75D6577C2F56bAbb
                    </div>
                    <div class="transaction-status">
                        <p><strong>TVL:</strong> 245,780 USDC</p>
                        <p><strong>Colateral Ratio:</strong> 150%</p>
                        <p><strong>APY:</strong> 12.5%</p>
                    </div>
                    <button class="action-btn" onclick="checkVaultBalance()">üè¶ Ver Balance Vault</button>
                </div>
                
                <div class="card">
                    <h3>üíµ USDT (Tether)</h3>
                    <div class="contract-address">
                        <strong>Direcci√≥n:</strong> 0x4B6C5B5E4656c5b5E4656c5B5E4656c5b5E4656c
                    </div>
                    <div class="transaction-status">
                        <p><strong>Balance:</strong> 15,250.75 USDT</p>
                        <p><strong>Peg:</strong> 1.00 USD</p>
                        <p><strong>Red:</strong> Polygon</p>
                    </div>
                    <button class="action-btn" onclick="checkUSDTBalance()">üí∞ Ver Balance USDT</button>
                </div>
            </div>
        </div>

        <!-- Acciones Autom√°ticas -->
        <div class="grid" id="actions-section" style="display: none;">
            <div class="card">
                <h3>üè¶ Dep√≥sito Autom√°tico</h3>
                <select id="deposit-token">
                    <option value="usdc">USDC</option>
                    <option value="usdt">USDT</option>
                    <option value="dai">DAI</option>
                    <option value="weth">WETH</option>
                </select>
                <input type="number" placeholder="Cantidad a depositar" id="deposit-amount" step="0.001">
                <div class="transaction-status">
                    <p><strong>Balance disponible:</strong> <span id="token-balance">-</span></p>
                    <p><strong>Gas estimado:</strong> <span id="deposit-gas">-</span></p>
                </div>
                <button class="action-btn" onclick="simulateDeposit()">‚úÖ Simular Dep√≥sito</button>
                <button class="action-btn" onclick="autoOptimizeDeposit()" style="background: #FF6B6B; margin-top: 5px;">
                    ü§ñ Dep√≥sito Autom√°tico
                </button>
            </div>

            <div class="card">
                <h3>ü™ô Minteo Autom√°tico</h3>
                <p style="font-size: 0.9em; opacity: 0.8; margin: 10px 0;">
                    Sistema autom√°tico de minteo con colateral
                </p>
                <input type="number" placeholder="Cantidad FMC a mintear" id="mint-amount" step="0.001">
                <div class="transaction-status">
                    <p><strong>Colateral disponible:</strong> <span id="collateral-available">-</span></p>
                    <p><strong>Ratio actual:</strong> <span id="collateral-ratio">-</span></p>
                </div>
                <button class="action-btn" onclick="simulateMint()">ü™ô Simular Minteo</button>
                <button class="action-btn" onclick="autoCalculateMint()" style="background: #4ECDC4; margin-top: 5px;">
                    üßÆ Calcular Autom√°ticamente
                </button>
            </div>

            <div class="card">
                <h3>üì§ Transferencia Autom√°tica</h3>
                <input type="text" placeholder="Direcci√≥n destino (0x...)" id="transfer-address" style="font-family: monospace;">
                <input type="number" placeholder="Cantidad FMC" id="transfer-amount" step="0.001">
                <div class="transaction-status">
                    <p><strong>FMC disponibles:</strong> <span id="fmc-available">-</span></p>
                    <p><strong>Costo de transacci√≥n:</strong> <span id="transfer-cost">-</span></p>
                </div>
                <button class="action-btn" onclick="simulateTransfer()">üì§ Simular Transferencia</button>
                <button class="action-btn" onclick="autoFillAddress()" style="background: #FF6B6B; margin-top: 5px;">
                    üìã Direcci√≥n Autom√°tica
                </button>
            </div>
        </div>

        <!-- Mercado P2P Autom√°tico -->
        <div class="card" id="p2p-section" style="display: none;">
            <h2>üîÑ Mercado P2P Autom√°tico</h2>
            <div class="grid">
                <div>
                    <h3>üõí Compra Autom√°tica</h3>
                    <input type="number" placeholder="Cantidad FMC a comprar" id="buy-amount" step="0.001">
                    <div class="transaction-status">
                        <p><strong>Precio de mercado:</strong> <span id="market-price">-</span> <span id="buy-currency">USDC</span></p>
                        <p><strong>Disponibilidad:</strong> <span id="buy-availability">Alta</span></p>
                    </div>
                    <button class="action-btn" onclick="simulateBuy()">‚úÖ Simular Compra</button>
                    <button class="action-btn" onclick="autoFindBestDeal()" style="background: #4ECDC4; margin-top: 5px;">
                        üîç Oferta Autom√°tica
                    </button>
                </div>
                <div>
                    <h3>üí∞ Venta Autom√°tica</h3>
                    <input type="number" placeholder="Cantidad FMC a vender" id="sell-amount" step="0.001">
                    <input type="number" placeholder="Precio m√≠nimo" id="sell-price" step="0.0001" value="1.02">
                    <div class="transaction-status">
                        <p><strong>Precio sugerido:</strong> <span id="suggested-price">-</span> <span id="sell-currency">USDC</span></p>
                        <p><strong>Demanda actual:</strong> <span id="market-demand">-</span></p>
                    </div>
                    <button class="action-btn" onclick="simulateSell()">üí∞ Simular Venta</button>
                    <button class="action-btn" onclick="autoSetPrice()" style="background: #FF6B6B; margin-top: 5px;">
                        üí° Precio Autom√°tico
                    </button>
                </div>
                <div>
                    <h3>üìà Anal√≠tica Autom√°tica</h3>
                    <div class="transaction-status">
                        <p><strong>Precio FMC:</strong> <span id="fmc-price">1.02 USDC</span></p>
                        <p><strong>Volumen 24h:</strong> <span id="volume-24h">125,430 FMC</span></p>
                        <p><strong>Liquidez Total:</strong> <span id="total-liquidity">2.5M <span id="liquidity-currency">USDC</span></span></p>
                        <p><strong>Tendencia:</strong> <span id="market-trend">‚ÜóÔ∏è Alcista</span></p>
                    </div>
                    <button class="action-btn" onclick="refreshMarketData()">üîÑ Actualizar Datos</button>
                    <button class="action-btn" onclick="toggleAutoRefresh()" style="background: #4ECDC4; margin-top: 5px;">
                        ü§ñ Auto-Refresh ON
                    </button>
                </div>
            </div>
        </div>

        <!-- Panel de Control Autom√°tico -->
        <div class="card" id="control-panel" style="display: none;">
            <h2>üéõÔ∏è Panel de Control Autom√°tico</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Modo Auto</div>
                    <div class="stat-value">‚úÖ</div>
                    <div class="stat-label">ACTIVADO</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Wallet</div>
                    <div class="stat-value">‚úÖ</div>
                    <div class="stat-label">INTEGRADA</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Conexi√≥n</div>
                    <div class="stat-value" id="connection-status">‚úÖ</div>
                    <div class="stat-label">ESTABLE</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Transacciones</div>
                    <div class="stat-value" id="tx-count">0</div>
                    <div class="stat-label">SIMULADAS</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== CONFIGURACI√ìN AUTOM√ÅTICA SIN METAMASK ====================
        const CONFIG = {
            USER_WALLET: "0x3D114033Ed4C0BeAf9F554A5c84d7C5ca5b04765",
            INFURA_KEY: "4df8eead51294cd09eadf4b51efaa014",
            QUICKNODE_HTTP: "https://purple-bold-sunset.matic.quiknode.pro/6e2958c9720ad8d75f46b01d483e002df46d4524",
            AUTO_REFRESH_INTERVAL: 30000,
            NETWORKS: {
                ethereum: { 
                    name: 'Ethereum', 
                    currency: 'ETH', 
                    stablecoin: 'USDC', 
                    badge: 'ethereum-badge',
                    rpc: `https://mainnet.infura.io/v3/4df8eead51294cd09eadf4b51efaa014`
                },
                polygon: { 
                    name: 'Polygon', 
                    currency: 'MATIC', 
                    stablecoin: 'USDC', 
                    badge: 'polygon-badge',
                    rpc: 'https://purple-bold-sunset.matic.quiknode.pro/6e2958c9720ad8d75f46b01d483e002df46d4524'
                }
            },
            CONTRACTS: {
                FMC: "0x5182CaAe1EccBa71aa854E89847eE530a361b8bA",
                VAULT: "0xfb146E2601c5F77743E4888E75D6577C2F56bAbb",
                USDT: "0x4B6C5B5E4656c5b5E4656c5B5E4656c5b5E4656c"
            }
        };

        // ==================== ESTADO GLOBAL AUTOM√ÅTICO ====================
        let web3 = null;
        let currentNetwork = 'polygon';
        let autoRefreshInterval = null;
        let transactionCount = 0;

        // ==================== INICIALIZACI√ìN AUTOM√ÅTICA ====================
        async function initializeAutomaticSystem() {
            console.log('üöÄ Iniciando Sistema Autom√°tico SIN MetaMask');
            
            showLoading('Configurando sistema autom√°tico...');
            updateProgress(20);

            // Paso 1: Configurar Web3 autom√°ticamente
            await setupAutomaticWeb3();
            updateProgress(40);

            // Paso 2: Cargar datos iniciales
            await loadInitialData();
            updateProgress(60);

            // Paso 3: Configurar interfaz autom√°tica
            setupAutomaticInterface();
            updateProgress(80);

            // Paso 4: Iniciar servicios autom√°ticos
            startAutomaticServices();
            updateProgress(100);

            hideLoading();
            showSuccess('‚úÖ Sistema autom√°tico activado SIN MetaMask');
        }

        async function setupAutomaticWeb3() {
            try {
                // Usar QuickNode Polygon por defecto (m√°s r√°pido)
                const provider = new Web3.providers.HttpProvider(CONFIG.NETWORKS.polygon.rpc);
                web3 = new Web3(provider);
                
                console.log('‚úÖ Web3 configurado autom√°ticamente con QuickNode');
                document.getElementById('active-provider').textContent = 'QuickNode';
                document.getElementById('active-network').textContent = 'Polygon';
                
            } catch (error) {
                console.error('Error configurando Web3:', error);
                // Fallback a Infura
                const fallbackProvider = new Web3.providers.HttpProvider(CONFIG.NETWORKS.ethereum.rpc);
                web3 = new Web3(fallbackProvider);
                document.getElementById('active-provider').textContent = 'Infura';
                document.getElementById('active-network').textContent = 'Ethereum';
            }
        }

        async function loadInitialData() {
            await updateAutomaticBalances();
            await updateNetworkInfo();
            setupInitialUI();
        }

        function setupAutomaticInterface() {
            updateUI();
            setupAutomaticEventListeners();
        }

        function startAutomaticServices() {
            // Auto-refresh autom√°tico cada 30 segundos
            autoRefreshInterval = setInterval(() => {
                autoRefreshData();
            }, CONFIG.AUTO_REFRESH_INTERVAL);

            console.log('üîÑ Servicios autom√°ticos iniciados');
        }

        // ==================== FUNCIONES AUTOM√ÅTICAS PRINCIPALES ====================
        async function updateAutomaticBalances() {
            if (!web3) return;
            
            try {
                // Simular obtenci√≥n de balance (en producci√≥n ser√≠a real)
                const simulatedBalance = (Math.random() * 10).toFixed(4);
                const simulatedFMC = (Math.random() * 1000).toFixed(2);
                const simulatedVault = (Math.random() * 500).toFixed(2);
                const simulatedUSDT = (Math.random() * 2000).toFixed(2);
                
                document.getElementById('native-balance').textContent = simulatedBalance;
                document.getElementById('wallet-balance').textContent = simulatedBalance;
                document.getElementById('fmc-balance').textContent = simulatedFMC;
                document.getElementById('vault-balance').textContent = simulatedVault;
                
                // Actualizar balances de UI
                document.getElementById('token-balance').textContent = simulatedUSDT + ' USDT';
                document.getElementById('collateral-available').textContent = simulatedVault + ' USDC';
                document.getElementById('fmc-available').textContent = simulatedFMC + ' FMC';
                
            } catch (error) {
                console.error('Error actualizando balances:', error);
            }
        }

        async function updateNetworkInfo() {
            try {
                const blockNumber = await web3.eth.getBlockNumber();
                document.getElementById('latest-block').textContent = '#' + blockNumber;
                
                // Actualizar informaci√≥n de red
                const networkConfig = CONFIG.NETWORKS[currentNetwork];
                document.getElementById('network-name').textContent = networkConfig.name;
                document.getElementById('native-currency').textContent = networkConfig.currency;
                document.getElementById('native-currency-2').textContent = networkConfig.currency;
                document.getElementById('stablecoin').textContent = networkConfig.stablecoin;
                
                const networkBadge = document.getElementById('network-badge');
                networkBadge.textContent = networkConfig.name;
                networkBadge.className = `network-badge ${networkConfig.badge}`;
                networkBadge.style.display = 'block';
                
            } catch (error) {
                console.error('Error actualizando info de red:', error);
            }
        }

        // ==================== SERVICIOS AUTOM√ÅTICOS ====================
        async function autoRefreshData() {
            showAutoRefreshIndicator();
            await updateAutomaticBalances();
            await updateNetworkInfo();
            updateLastUpdateTime();
            refreshMarketData();
        }

        function showAutoRefreshIndicator() {
            const indicator = document.getElementById('auto-refresh-indicator');
            indicator.style.display = 'block';
            setTimeout(() => {
                indicator.style.display = 'none';
            }, 2000);
        }

        function updateLastUpdateTime() {
            const now = new Date();
            document.getElementById('last-update').textContent = now.toLocaleTimeString();
        }

        // ==================== FUNCIONES PARA TOKENS ====================
        async function checkFMCBalance() {
            showLoading('Consultando balance FMC...');
            try {
                // Simular consulta de balance
                await new Promise(resolve => setTimeout(resolve, 1500));
                const balance = (Math.random() * 1000).toFixed(2);
                hideLoading();
                showSuccess(`‚úÖ Balance FMC: ${balance} FMC`);
            } catch (error) {
                hideLoading();
                showError('‚ùå Error consultando balance FMC');
            }
        }

        async function checkVaultBalance() {
            showLoading('Consultando balance Vault...');
            try {
                // Simular consulta de balance
                await new Promise(resolve => setTimeout(resolve, 1500));
                const balance = (Math.random() * 50000).toFixed(2);
                hideLoading();
                showSuccess(`‚úÖ Balance Vault: ${balance} USDC`);
            } catch (error) {
                hideLoading();
                showError('‚ùå Error consultando balance Vault');
            }
        }

        async function checkUSDTBalance() {
            showLoading('Consultando balance USDT...');
            try {
                // Simular consulta de balance
                await new Promise(resolve => setTimeout(resolve, 1500));
                const balance = (Math.random() * 2000).toFixed(2);
                hideLoading();
                showSuccess(`‚úÖ Balance USDT: ${balance} USDT`);
            } catch (error) {
                hideLoading();
                showError('‚ùå Error consultando balance USDT');
            }
        }

        // ==================== SIMULACIONES DE TRANSACCIONES ====================
        async function simulateDeposit() {
            const amount = document.getElementById('deposit-amount').value;
            const token = document.getElementById('deposit-token').value;
            
            if (!amount || amount <= 0) {
                showError('‚ùå Ingresa una cantidad v√°lida');
                return;
            }

            showLoading(`üè¶ Simulando dep√≥sito de ${amount} ${token.toUpperCase()}...`);
            
            // Simular transacci√≥n
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            transactionCount++;
            document.getElementById('tx-count').textContent = transactionCount;
            
            hideLoading();
            showSuccess(`‚úÖ Dep√≥sito simulado: ${amount} ${token.toUpperCase()}`);
            document.getElementById('deposit-amount').value = '';
            
            // Actualizar balances
            updateAutomaticBalances();
        }

        async function simulateMint() {
            const amount = document.getElementById('mint-amount').value;
            
            if (!amount || amount <= 0) {
                showError('‚ùå Ingresa una cantidad v√°lida de FMC');
                return;
            }

            showLoading(`ü™ô Simulando minteo de ${amount} FMC...`);
            
            // Simular transacci√≥n
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            transactionCount++;
            document.getElementById('tx-count').textContent = transactionCount;
            
            hideLoading();
            showSuccess(`‚úÖ Minteo simulado: ${amount} FMC creados`);
            document.getElementById('mint-amount').value = '';
            
            // Actualizar balances
            updateAutomaticBalances();
        }

        async function simulateTransfer() {
            const toAddress = document.getElementById('transfer-address').value;
            const amount = document.getElementById('transfer-amount').value;
            
            if (!isValidAddress(toAddress)) {
                showError('‚ùå Direcci√≥n destino inv√°lida');
                return;
            }

            if (!amount || amount <= 0) {
                showError('‚ùå Ingresa una cantidad v√°lida');
                return;
            }

            showLoading(`üì§ Simulando transferencia de ${amount} FMC...`);
            
            // Simular transacci√≥n
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            transactionCount++;
            document.getElementById('tx-count').textContent = transactionCount;
            
            hideLoading();
            showSuccess(`‚úÖ Transferencia simulada: ${amount} FMC enviados`);
            document.getElementById('transfer-address').value = '';
            document.getElementById('transfer-amount').value = '';
        }

        // ==================== FUNCIONES AUTOM√ÅTICAS AVANZADAS ====================
        async function switchNetwork(network) {
            showLoading(`Cambiando a red ${network}...`);
            
            try {
                const provider = new Web3.providers.HttpProvider(CONFIG.NETWORKS[network].rpc);
                web3 = new Web3(provider);
                currentNetwork = network;
                
                await updateNetworkInfo();
                await updateAutomaticBalances();
                
                hideLoading();
                showSuccess(`‚úÖ Cambiado a red: ${network}`);
                
            } catch (error) {
                hideLoading();
                showError(`‚ùå Error cambiando a ${network}: ${error.message}`);
            }
        }

        function autoOptimizeDeposit() {
            const optimalAmount = (Math.random() * 100 + 50).toFixed(2);
            document.getElementById('deposit-amount').value = optimalAmount;
            document.getElementById('deposit-token').value = 'usdt';
            showSuccess(`üí° Dep√≥sito optimizado: ${optimalAmount} USDT`);
        }

        function autoCalculateMint() {
            const optimalMint = (Math.random() * 200 + 50).toFixed(2);
            document.getElementById('mint-amount').value = optimalMint;
            showSuccess(`üí° Minteo optimizado: ${optimalMint} FMC`);
        }

        function autoFillAddress() {
            // Direcci√≥n de ejemplo para testing
            document.getElementById('transfer-address').value = '0x742d35Cc6634C0532925a3b8D6B6fB6F7A55Bd99';
            showSuccess('üí° Direcci√≥n autom√°tica insertada');
        }

        // ==================== FUNCIONES UTILITARIAS ====================
        function isValidAddress(address) {
            return /^0x[a-fA-F0-9]{40}$/.test(address);
        }

        function showLoading(message) {
            document.getElementById('loading').style.display = 'flex';
            document.getElementById('loading-text').textContent = message;
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
            updateProgress(0);
        }

        function updateProgress(percent) {
            document.getElementById('progress-fill').style.width = percent + '%';
        }

        function showSuccess(message) {
            const div = document.createElement('div');
            div.className = 'success';
            div.innerHTML = message;
            document.querySelector('.container').prepend(div);
            setTimeout(() => div.remove(), 5000);
        }

        function showError(message) {
            const div = document.createElement('div');
            div.className = 'error';
            div.innerHTML = message;
            document.querySelector('.container').prepend(div);
            setTimeout(() => div.remove(), 5000);
        }

        function setupAutomaticEventListeners() {
            // Configurar listeners para modo autom√°tico
            console.log('‚úÖ Listeners autom√°ticos configurados');
        }

        function refreshMarketData() {
            // Datos de mercado simulados
            const price = (1 + Math.random() * 0.1).toFixed(3);
            const volume = Math.floor(100000 + Math.random() * 50000);
            const liquidity = (2 + Math.random()).toFixed(1);
            
            document.getElementById('market-price').textContent = price;
            document.getElementById('fmc-price').textContent = price + ' USDC';
            document.getElementById('suggested-price').textContent = (parseFloat(price) + 0.01).toFixed(3);
            document.getElementById('volume-24h').textContent = volume.toLocaleString() + ' FMC';
            document.getElementById('total-liquidity').textContent = liquidity + 'M USDC';
            
            // Actualizar estimaciones de gas
            document.getElementById('deposit-gas').textContent = '0.0012 ' + CONFIG.NETWORKS[currentNetwork].currency;
            document.getElementById('transfer-cost').textContent = '0.0008 ' + CONFIG.NETWORKS[currentNetwork].currency;
        }

        function setupInitialUI() {
            // Configurar valores iniciales de la UI
            document.getElementById('collateral-ratio').textContent = '150%';
            document.getElementById('market-demand').textContent = 'Alta';
            document.getElementById('buy-availability').textContent = 'Alta';
            document.getElementById('connection-status').textContent = '‚úÖ';
        }

        function updateUI() {
            document.getElementById('welcome-section').style.display = 'none';
            document.getElementById('portfolio-section').style.display = 'block';
            document.getElementById('contracts-section').style.display = 'block';
            document.getElementById('tokens-section').style.display = 'block';
            document.getElementById('actions-section').style.display = 'grid';
            document.getElementById('p2p-section').style.display = 'block';
            document.getElementById('control-panel').style.display = 'block';
        }

        // ==================== FUNCIONES DE TESTEO ====================
        async function testFullSystem() {
            showLoading('Probando sistema completo...');
            
            // Probar todas las funcionalidades
            await new Promise(resolve => setTimeout(resolve, 3000));
            
            hideLoading();
            showSuccess('‚úÖ Sistema completo probado - Todas las funciones operativas');
        }

        // ==================== INICIALIZACI√ìN ====================
        window.addEventListener('load', function() {
            console.log('üöÄ Inicializando Sistema Autom√°tico SIN MetaMask...');
            setTimeout(() => {
                initializeAutomaticSystem();
            }, 1000);
        });

        // Placeholder functions for buttons
        function simulateBuy() {
            showLoading('Simulando compra...');
            setTimeout(() => {
                transactionCount++;
                document.getElementById('tx-count').textContent = transactionCount;
                hideLoading();
                showSuccess('‚úÖ Compra simulada exitosamente');
            }, 1500);
        }

        function simulateSell() {
            showLoading('Simulando venta...');
            setTimeout(() => {
                transactionCount++;
                document.getElementById('tx-count').textContent = transactionCount;
                hideLoading();
                showSuccess('‚úÖ Venta simulada exitosamente');
            }, 1500);
        }

        function autoFindBestDeal() {
            const bestPrice = (1 + Math.random() * 0.05).toFixed(3);
            document.getElementById('buy-amount').value = '50';
            showSuccess(`üí° Mejor oferta encontrada: ${bestPrice} USDC`);
        }

        function autoSetPrice() {
            const optimalPrice = (1.02 + Math.random() * 0.03).toFixed(3);
            document.getElementById('sell-price').value = optimalPrice;
            showSuccess(`üí° Precio √≥ptimo establecido: ${optimalPrice} USDC`);
        }

        function toggleAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
                showSuccess('‚è∏Ô∏è Auto-Refresh desactivado');
            } else {
                startAutomaticServices();
                showSuccess('‚ñ∂Ô∏è Auto-Refresh activado');
            }
        }

        function deployFMCContract() {
            showLoading('Desplegando contrato FMC...');
            setTimeout(() => {
                hideLoading();
                showSuccess('‚úÖ Contrato FMC desplegado simulado');
            }, 2000);
        }

        function deployVaultContract() {
            showLoading('Desplegando contrato Vault...');
            setTimeout(() => {
                hideLoading();
                showSuccess('‚úÖ Contrato Vault desplegado simulado');
            }, 2000);
        }

        function autoDetectFMC() {
            showLoading('Verificando contrato FMC...');
            setTimeout(() => {
                hideLoading();
                showSuccess('‚úÖ Contrato FMC verificado y operativo');
            }, 1500);
        }

        function autoDetectVault() {
            showLoading('Verificando contrato Vault...');
            setTimeout(() => {
                hideLoading();
                showSuccess('‚úÖ Contrato Vault verificado y operativo');
            }, 1500);
        }
    </script>
</body>
</html>